{
    "openapi": "3.0.0",
    "info": {
        "version": "1.0",
        "title": "API red de sensores",
        "description": "Documentacion de los endpoints disponibles para el proyecto de red de sensores",
        "license": {
            "name": "ITESO",
            "url": "https://www.iteso.mx/"
        }
    },
    "paths": {
        "/nodes": {
            "get": {
                "description": "The description",
                "operationId": "getNodes",
                "responses": {
                    "200": {
                        "description": "OK",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Nodes"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/lecturas": {
            "get": {
                "tags": [
                    "Lecturas"
                ],
                "description": "Inserta una lectura en la base de datos",
                "operationId": "postLectura",
                "parameters": [
                    {
                        "name": "cmd",
                        "in": "query",
                        "description": "Lectura de nodo a insertar",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Lectura creada satisfactoriamente"
                    }
                }
            }
        },
        "/lecturas/t": {
            "get": {
                "tags": [
                    "Lecturas"
                ],
                "description": "Obtiene las últimas lecturas de todos los nodos",
                "operationId": "getTLecturas",
                "parameters": [
                    {
                        "name": "count",
                        "in": "query",
                        "description": "Número máximo de lecturas, por defecto 100",
                        "required": false,
                        "type": "integer",
                        "default": "100"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lecturas obtenidas satisfactoriamente"
                    }
                }
            }
        },
        "/lecturas/id/{id}": {
            "get": {
                "tags": [
                    "Lecturas"
                ],
                "description": "Obtiene una lectura con un ID específico",
                "operationId": "getLecturaId",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Id a consultar la lectura",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lectura obtenida satisfactoriamente"
                    }
                }
            },
            "put": {
                "tags": [
                    "Lecturas"
                ],
                "description": "Actualiza una lectura con un ID específico",
                "operationId": "putLecturaId",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Id a actualizar la lectura",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lectura actualizada satisfactoriamente"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Lecturas"
                ],
                "description": "Elimina una lectura con un ID específico",
                "operationId": "deleteLecturaId",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Id a la lectura",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lectura eliminada satisfactoriamente"
                    }
                }
            }
        },
        "/lecturas/n/{nodo}": {
            "get": {
                "tags": [
                    "Lecturas"
                ],
                "description": "Obtiene las últimas lecturas de un nodo en específico",
                "operationId": "getLecturasNodo",
                "parameters": [
                    {
                        "name": "nodo",
                        "in": "path",
                        "description": "Id del nodo a consultar las lecturas",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "count",
                        "in": "query",
                        "description": "Número máximo de lecturas, por defecto 100",
                        "required": false,
                        "type": "integer",
                        "default": "100"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lecturas obtenidas satisfactoriamente",
                        "content": {
                            "application/json": {
                                "type": "array"
                            }
                        }
                    }
                }
            }
        },
        "/lecturas/dia/{nodo}/{año}/{mes}/{dia}": {
            "get": {
                "tags": [
                    "Lecturas"
                ],
                "description": "Obtiene las lecturas de un nodo en específico en un día",
                "operationId": "getLecturasNodoDia",
                "parameters": [
                    {
                        "name": "nodo",
                        "in": "path",
                        "description": "Id del nodo a consultar las lecturas",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "año",
                        "in": "path",
                        "description": "Año a consultar las lecturas",
                        "required": true,
                        "type": "integer"
                    },
                    {
                        "name": "mes",
                        "in": "path",
                        "description": "Mes a consultar las lecturas",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "dia",
                        "in": "path",
                        "description": "Día a consultar las lecturas",
                        "required": true,
                        "type": "integer"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lecturas obtenidas satisfactoriamente",
                        "application/json": {
                            "type": "array"
                        }
                    }
                }
            }
        },
        "/lecturas/semana/{nodo}/{año}/{mes}/{dia}": {
            "get": {
                "tags": [
                    "Lecturas"
                ],
                "description": "Obtiene las lecturas de un nodo en específico en una semana",
                "operationId": "getLecturasNodoSemana",
                "parameters": [
                    {
                        "name": "nodo",
                        "in": "path",
                        "description": "Id del nodo a consultar las lecturas",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "año",
                        "in": "path",
                        "description": "Año a consultar las lecturas",
                        "required": true,
                        "type": "integer"
                    },
                    {
                        "name": "mes",
                        "in": "path",
                        "description": "Mes a consultar las lecturas",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "dia",
                        "in": "path",
                        "description": "Día a consultar las lecturas",
                        "required": true,
                        "type": "integer"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lecturas obtenidas satisfactoriamente",
                        "application/json": {
                            "type": "array"
                        }
                    }
                }
            }
        },
        "/lecturas/mes/{nodo}/{año}/{mes}": {
            "get": {
                "tags": [
                    "Lecturas"
                ],
                "description": "Obtiene las lecturas de un nodo en específico en un mes",
                "operationId": "getLecturasNodoMes",
                "parameters": [
                    {
                        "name": "nodo",
                        "in": "path",
                        "description": "Id del nodo a consultar las lecturas",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "año",
                        "in": "path",
                        "description": "Año a consultar las lecturas",
                        "required": true,
                        "type": "integer"
                    },
                    {
                        "name": "mes",
                        "in": "path",
                        "description": "Mes a consultar las lecturas",
                        "required": true,
                        "type": "string"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lecturas obtenidas satisfactoriamente",
                        "application/json": {
                            "type": "array"
                        }
                    }
                }
            }
        },
        "/lecturas/anio/{nodo}/{año}": {
            "get": {
                "tags": [
                    "Lecturas"
                ],
                "description": "Obtiene las lecturas de un nodo en específico en un año",
                "operationId": "getLecturasNodoAño",
                "parameters": [
                    {
                        "name": "nodo",
                        "in": "path",
                        "description": "Id del nodo a consultar las lecturas",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "año",
                        "in": "path",
                        "description": "Año a consultar las lecturas",
                        "required": true,
                        "type": "integer"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lecturas obtenidas satisfactoriamente",
                        "application/json": {
                            "type": "array"
                        }
                    }
                }
            }
        },
        "/variables": {
            "get": {
                "tags": [
                    "Variables"
                ],
                "description": "Obtiene todo el catálogo de valores",
                "operationId": "getVariables",
                "responses": {
                    "200": {
                        "description": "Valores del catálogo obtenidos satisfactoriamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#components/schemas/Values"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "Variables"
                ],
                "description": "Crea un nuevo registro en el catálogo de valores",
                "operationId": "postVariable",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#components/schemas/Values"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Registro en el catáogo creado satisfactoriamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#components/schemas/Values"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/variables/{id}": {
            "get": {
                "tags": [
                    "Variables"
                ],
                "description": "Obtiene todo el catálogo de valores",
                "operationId": "getVariable",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Id del registro a consultar",
                        "required": true,
                        "type": "integer"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Valores del catálogo obtenidos satisfactoriamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#components/schemas/Values"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "tags": [
                    "Variables"
                ],
                "description": "Crea un nuevo registro en el catálogo de valores",
                "operationId": "putVaraible",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Id del registro a actualizar",
                        "required": true,
                        "type": "integer"
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#components/schemas/Values"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Registro en el catáogo actualizado satisfactoriamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#components/schemas/Values"
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "tags": [
                    "Variables"
                ],
                "description": "Crea un nuevo registro en el catálogo de valores",
                "operationId": "deleteVariable",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Id del registro a eliminar",
                        "required": true,
                        "type": "integer"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Registro en el catáogo eliminado satisfactoriamente"
                    }
                }
            }
        }
    },
    "servers": [
        {
            "description": "Host",
            "url": "http://papvidadigital-test.com/api/1.0"
        }
    ],
    "components": {
        "schemas": {
            "Nodes": {
                "description": "Descripción de los nodos",
                "properties": {
                    "id": {
                        "type": "integer",
                        "format": "int64"
                    }
                }
            },
            "Values": {
                "description": "Esquema del catálogo de variables",
                "properties": {
                    "id": {
                        "type": "integer",
                        "format": "int32"
                    },
                    "description": {
                        "type": "string"
                    },
                    "code": {
                        "type": "string"
                    },
                    "abr": {
                        "type": "string"
                    },
                    "min": {
                        "type": "integer",
                        "format": "int32"
                    },
                    "max": {
                        "type": "integer",
                        "format": "int32"
                    },
                    "referenceVal": {
                        "type": "integer",
                        "format": "int32"
                    },
                    "ambiental": {
                        "type": "boolean"
                    }
                }
            },
            "LecturaJSON":{
                "id": {
                    "required": true,
                    "type": "string"
                },
                "ts": {
                    "type": "string"
                },
                "se": {
                    "type": "string"
                },
                "bat": {
                    "type": "string"
                },
                "temp": {
                    "type": "string"
                },
                "ph": {
                    "type": "string"
                },
                "od": {
                    "type": "string"
                },
                "tmps": {
                    "type": "string"
                },
                "tmpi": {
                    "type": "string"
                },
                "hums": {
                    "type": "string"
                },
                "con": {
                    "type": "string"
                },
                "orp": {
                    "type": "string"
                },
                "o2": {
                    "type": "string"
                },
                "co": {
                    "type": "string"
                },
                "no2": {
                    "type": "string"
                },
                "cO2": {
                    "type": "string"
                },
                "hum": {
                    "type": "string"
                },
                "o3": {
                    "type": "string"
                },
                "pru": {
                    "type": "string"
                },
                "vel": {
                    "type": "string"
                },
                "prec": {
                    "type": "string"
                },
                "dir": {
                    "type": "string"
                }
            },
            "Lecturas": {
                "id": {
                    "type": "integer",
                    "format": "int32"
                },
                "idNodo": {
                    "type": "string"
                },
                "data": {
                    "type": {
                        "$ref": "#/components/schemas/LecturaJSON"
                    }
                },
                "fecha_hora": {
                    "type": "string"
                }
            }
        }
    }
}